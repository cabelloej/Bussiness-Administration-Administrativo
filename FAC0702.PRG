
***
*ON ERROR DO ERRCON
*STORE SPACE(40) TO QQWW
*STORE "CONSTRUCTORA LA ESTANCIA DORADA, C.A.   " TO T3
*STORE 0 TO PPP
*DO INFORMA
*if qqww<>t3
*    store 1 to ppp
*endif
*if ppp = 1
*   store "ERROR DE INSTALACION" to mes
*   do aviso with mes
*   close all
*   quit
*endif
***
SET TALK OFF
SET ECHO OFF
STORE .F. TO WFLAGACT
STORE .F. TO FLAGASK
SAVE SCRE TO S4
@ 10,54 CLEAR TO 15,77
@ 10,54 TO 15,77
@ 11,55 PROMPT "PRESUPUESTOS          "
@ 12,55 PROMPT "ORDENES DE COMPRA     "
@ 13,55 PROMPT "NOTAS DE ENTREGA      "
@ 14,55 PROMPT "FACTURAS              "
MENU TO WSUBOP7
IF WSUBOP7 = 0
   CLOSE DATA
   CLOSE INDEX
   RETURN
ENDIF
IF WSUBOP7 <> 2
   STORE "INDIQUE EL NUMERO DEL DOCUMENTO:" TO MES
   DO MENSAJE WITH MES
   STORE SPACE(7) TO WNUMERO
   @ 23,60 GET WNUMERO
   READ
ELSE
   STORE "INDIQUE NUMERO DE DOCUMENTO:" TO MES
   DO MENSAJE WITH MES
   STORE SPACE(20) TO WNUMERO
   @ 23,58 GET WNUMERO
   READ
ENDIF
IF WNUMERO = SPACE(7) .AND. WNUMERO = SPACE(20)
   RETURN
ENDIF
DO CASE
   CASE WSUBOP7 = 1
        STORE "PRE" TO WTIPODOC
        STORE "PRESUPUESTO" TO WDOCDES
   CASE WSUBOP7 = 2
        STORE "ORD" TO WTIPODOC
        STORE "ORDEN DE COMPRA" TO WDOCDES
   CASE WSUBOP7 = 3
        STORE "NOT" TO WTIPODOC
        STORE "NOTA DE ENTREGA" TO WDOCDES
   CASE WSUBOP7 = 4
        STORE "FAC" TO WTIPODOC
        STORE "FACTURA" TO WDOCDES
ENDCASE
STORE WTIPODOC+WNUMERO TO WNUMERO2
DO FACIMPDC
restore scre from s4
CLOSE DATA
CLOSE INDEX
RETURN

